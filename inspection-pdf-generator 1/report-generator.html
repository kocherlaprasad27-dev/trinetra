<!DOCTYPE html>
<html lang="en">

<head>
  <script src="db.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inspection Report - Print Version</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <style>
    /* --- Dynamic Page Numbering for Print/PDF --- */
    @media print {
      body {
        counter-reset: pageNum 1;
      }

      section:not(.cover) {
        counter-increment: pageNum;
      }

      .page-footer-right .dynamic-page-number::before {
        content: counter(pageNum);
      }

      .page-footer-right .dynamic-page-number {
        /* Hide JS number in print, show CSS counter */
        color: transparent;
        position: relative;
      }

      .page-footer-right .dynamic-page-number::before {
        color: #333;
        position: absolute;
        left: 0;
        top: 0;
      }
    }

    /* Enable page counter */
    @page {
      counter-increment: page;
    }

    /* Footer page number */
    .dynamic-page-number::after {
      content: counter(page);
    }

    /* Hide page number on first page */
    @page: first {
      counter-reset: page 1;
    }

    /* Hide footer page number on first page */
    @page: first {
      @bottom-right {
        content: "";
      }
    }

    /* Hide page number on first page only */
    @media print {
      body:first-of-type .dynamic-page-number {
        visibility: hidden;
      }
    }

    /* --- End Dynamic Page Numbering --- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fff;
    }

    .no-print {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      gap: 10px;
    }

    .print-btn {
      padding: 12px 24px;
      background: #473c39;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .print-btn:hover {
      background: #6b5d57;
    }

    section {
      padding: 40px;
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 20px;
      color: #2c3e50;
    }

    h2 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
      color: #2c3e50;
    }

    h3 {
      font-size: 20px;
      font-weight: 600;
      margin: 30px 0 15px;
      color: #34495e;
    }

    h4 {
      font-size: 16px;
      font-weight: 600;
      color: #34495e;
    }

    .cover {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: #e8e8e8;
      padding: 60px;
      position: relative;
      overflow: hidden;
    }

    .cover-logo {
      width: 200px;
      margin: 0 auto 40px auto;
    }

    .cover-layout {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      flex: 1;
      gap: 60px;
      margin-top: 20px;
    }

    .cover-left {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
    }

    .cover-title {
      font-size: 48px;
      font-weight: 800;
      line-height: 1.2;
      color: #2d2d2d;
      margin-bottom: 50px;
      letter-spacing: -1px;
      text-align: left;
    }

    .cover-address {
      font-size: 14px;
      color: #666;
      margin-bottom: 40px;
      line-height: 1.8;
      text-align: left;
    }

    .cover-prepared {
      display: flex;
      flex-direction: column;
      gap: 5px;
      text-align: left;
    }

    .cover-prepared span {
      font-size: 11px;
      color: #888;
      font-weight: 400;
    }

    .cover-prepared strong {
      font-size: 16px;
      color: #2d2d2d;
      font-weight: 600;
    }

    .cover-right {
      flex: 1;
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }

    .cover-right img {
      max-width: 350px;
      width: 100%;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    .cover-footer {
      display: flex;
      justify-content: space-between;
      padding-top: 20px;
      border-top: 1px solid #ccc;
      margin-top: auto;
    }

    .cover-footer div {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .cover-footer span {
      font-size: 10px;
      color: #888;
      font-weight: 400;
    }

    .cover-footer strong {
      font-size: 13px;
      color: #2d2d2d;
      font-weight: 600;
    }

    .cover-footer small {
      font-size: 10px;
      color: #999;
      margin-top: 2px;
    }

    .letterhead {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 40px;
      border-bottom: 4px solid #2c3e50;
      margin-bottom: 30px;
      background: linear-gradient(to right, #ffffff 0%, #ecf0f1 100%);
    }

    .letterhead-logo {
      height: 50px;
      width: auto;
    }

    .letterhead-text {
      text-align: right;
      color: #2c3e50;
    }

    .letterhead-text h2 {
      font-size: 24px;
      font-weight: 700;
      margin: 0;
      color: #2c3e50;
    }

    .letterhead-text p {
      font-size: 12px;
      margin: 5px 0 0 0;
      color: #7f8c8d;
    }

    .page-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 40px;
      border-top: 2px solid #2c3e50;
      margin-top: 30px;
      background: linear-gradient(to right, #ecf0f1 0%, #ffffff 100%);
      font-size: 11px;
      color: #7f8c8d;
    }

    .page-footer-left {
      display: flex;
      gap: 20px;
    }

    .page-footer-right {
      text-align: right;
    }

    .disclaimer-box p {
      margin-bottom: 10px;
      color: #34495e;
    }

    ul {
      list-style: none;
      margin-left: 0;
      margin-top: 10px;
      padding-left: 0;
    }

    li {
      margin-bottom: 12px;
      padding-left: 30px;
      position: relative;
      color: #34495e;
    }

    li::before {
      content: '‚ñ∏';
      position: absolute;
      left: 0;
      color: #f39c12;
      font-weight: bold;
      font-size: 18px;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .stat-box {
      background: linear-gradient(135deg, #ffffff 0%, #ecf0f1 100%);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      border: 2px solid #e8e8e8;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    }

    .stat-box.highlight {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      border-color: #2c3e50;
    }

    .stat-box .value {
      font-size: 36px;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .stat-box .label {
      font-size: 14px;
      color: #7f8c8d;
      font-weight: 500;
    }

    .stat-box.highlight .label {
      color: #ecf0f1;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: white;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      border-radius: 8px;
      overflow: hidden;
    }

    thead {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
    }

    th {
      padding: 18px;
      text-align: center;
      font-weight: 600;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    td {
      padding: 15px;
      border-bottom: 1px solid #ecf0f1;
      text-align: center;
      color: #34495e;
    }

    tbody tr {
      transition: background 0.2s ease;
    }

    tbody tr:hover {
      background: #f8f9fa;
    }

    tfoot {
      background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
      font-weight: 600;
      color: white;
    }

    tfoot td {
      border: none;
      padding: 18px;
    }

    .dimensions-table {
      width: 100%;
      border-collapse: collapse;
      font-family: 'Inter', sans-serif;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      table-layout: fixed;
      border-radius: 8px;
      overflow: hidden;
    }

    .dimensions-table thead tr {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    }

    .dimensions-header {
      background-color: #2c3e50;
      color: white;
      padding: 16px 10px;
      text-align: center;
      font-size: 11px;
      font-weight: 600;
      border: 1px solid #2c3e50;
      vertical-align: middle;
      word-wrap: break-word;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .dimensions-header:first-child {
      width: 15%;
    }

    .dimension-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }

    .dimension-icon svg {
      width: 40px;
      height: 40px;
      display: block;
      margin: 0 auto 5px auto;
    }

    .dimensions-table tbody tr {
      background-color: #f8f9fa;
    }

    .dimensions-table tbody tr:nth-child(even) {
      background-color: #ecf0f1;
    }

    .dimensions-table td {
      padding: 14px 10px;
      text-align: center;
      border: 1px solid #dee2e6;
      font-size: 12px;
      color: #2c3e50;
      font-weight: 500;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .room-label {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%) !important;
      color: white !important;
      font-weight: 700;
      text-align: left !important;
      padding-left: 20px !important;
      font-size: 13px !important;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .quality-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .quality-item {
      display: flex;
      flex-direction: column;
      gap: 15px;
      padding: 30px;
      background: #fff;
      border-radius: 12px;
      border: 3px solid #27ae60;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s ease;
    }

    .quality-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.12);
    }

    .quality-item.out-of-range {
      border-color: #e74c3c;
    }

    .quality-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .quality-label {
      font-size: 13px;
      color: #7f8c8d;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 600;
    }

    .quality-icon {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: bold;
      flex-shrink: 0;
    }

    .quality-icon.good {
      background: #27ae60;
      color: white;
    }

    .quality-icon.bad {
      background: #e74c3c;
      color: white;
    }

    .quality-value-container {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .quality-value {
      font-size: 48px;
      font-weight: 800;
      color: #27ae60;
      line-height: 1;
    }

    .quality-item.out-of-range .quality-value {
      color: #e74c3c;
    }

    .quality-unit {
      font-size: 22px;
      font-weight: 600;
      color: #27ae60;
    }

    .quality-item.out-of-range .quality-unit {
      color: #e74c3c;
    }

    .quality-range {
      font-size: 13px;
      color: #7f8c8d;
      margin-top: 8px;
      font-weight: 500;
    }

    .inspection-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: white;
      font-family: 'Inter', sans-serif;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      overflow: hidden;
    }

    .inspection-table thead {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    }

    .inspection-table thead th {
      background-color: #2c3e50;
      color: white;
      padding: 18px 15px;
      text-align: center;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #2c3e50;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .inspection-table tbody tr {
      background-color: #f8f9fa;
      border: 2px solid #dee2e6;
      transition: background 0.2s ease;
    }

    .inspection-table tbody tr:hover {
      background-color: #e9ecef;
    }

    .inspection-table tbody tr:nth-child(even) {
      background-color: #ecf0f1;
    }

    .inspection-table tbody td {
      padding: 20px 15px;
      text-align: left;
      border: 2px solid #dee2e6;
      font-size: 14px;
      color: #2c3e50;
      font-weight: 400;
      vertical-align: top;
    }

    .inspection-table tbody td:nth-child(1) {
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      font-weight: 800;
      width: 80px;
      text-align: center;
      font-size: 26px;
      color: white;
      vertical-align: middle;
    }

    .inspection-table tbody td:nth-child(2) {
      text-align: left;
      padding: 20px;
      width: 40%;
    }

    .inspection-table tbody td:nth-child(3) {
      width: 50%;
      padding: 15px;
    }

    .inspection-table-images {
      display: flex;
      flex-direction: column;
      gap: 15px;
      width: 100%;
    }

    .inspection-table-images img {
      width: 100%;
      max-width: 100%;
      height: auto;
      min-height: 200px;
      max-height: 300px;
      object-fit: cover;
      border-radius: 8px;
      border: 3px solid #2c3e50;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .room-quality-section {
      padding: 40px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .room-quality-header {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      padding: 18px 30px;
      margin: 0 -40px 30px -40px;
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .room-chart-container {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    }

    .room-chart-title {
      text-align: center;
      font-size: 16px;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .room-chart-wrapper {
      height: 360px;
      position: relative;
      overflow: hidden;
    }

    .page-break {
      page-break-after: always;
      height: 0;
      margin: 0;
      padding: 0;
    }

    @media print {
      .no-print {
        display: none;
      }

      .page-break {
        page-break-after: always;
      }

      .letterhead {
        page-break-inside: avoid;
      }

      body {
        print-color-adjust: exact;
        -webkit-print-color-adjust: exact;
      }

      @page {
        margin: 0.5cm;
        size: A4;
      }

    }

    @media (max-width: 768px) {
      .no-print {
        top: 10px;
        right: 10px;
        flex-direction: column;
        gap: 5px;
      }

      .print-btn {
        padding: 10px 15px;
        font-size: 12px;
      }

      section {
        padding: 20px;
      }

      .cover {
        padding: 20px;
      }

      .cover-layout {
        flex-direction: column;
        gap: 20px;
      }

      .cover-title {
        font-size: 36px;
      }

      .stats {
        grid-template-columns: 1fr;
      }

      .quality-grid {
        grid-template-columns: 1fr;
      }

      .inspection-table-images {
        flex-direction: column;
      }

      .inspection-table-images img {
        max-width: 100%;
        height: auto;
      }
    }
  </style>
</head>

<body>
  <div class="no-print">
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print / Save as PDF</button>
    <button class="print-btn" onclick="window.close()">‚úï Close</button>
  </div>
  <section class="cover">
    <div style="text-align: center;">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="cover-logo" />
    </div>

    <div class="cover-layout">
      <div class="cover-left">
        <h1 class="cover-title">INSPECTION<br />REPORT</h1>
        <p class="cover-address" id="propertyAddress">T6 ‚Äì 1307, My Home Tridasa<br />Hyderabad, TG ‚Äì 502032</p>
        <div class="cover-prepared">
          <span>Prepared for</span>
          <strong id="clientName">Mr. Hariprasad Sonti</strong>
        </div>
      </div>
      <div class="cover-right">
        <img src="assets/images/ins.webp" alt="Inspection" />
      </div>
    </div>

    <div class="cover-footer">
      <div>
        <span>Inspection Date</span>
        <strong id="inspectionDate">Dec 23, 2025</strong>
      </div>
      <div>
        <span>Inspected By</span>
        <strong id="inspectorName">John Smith</strong>
        <small id="verifierName">Verified by: Ketan Kumar</small>
      </div>
    </div>
  </section>

  <div class="page-break"></div>

  <section style="display: flex; flex-direction: column; min-height: 100vh;">
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <!-- Letterhead removed: now page-level only -->
    <h1>Disclaimer</h1>
    <div class="disclaimer-box">
      <p><strong>Trinetra</strong> is a brand of NS Property Guide Advisors Private Limited providing professional
        visual property inspection services.</p>
      <p>This inspection is non-invasive and limited to visible conditions observed on the inspection date.</p>
    </div>
    <h3 style="margin-top: 30px">Excluded Services</h3>
    <ul>
      <li>Structural, geotechnical and soil analysis</li>
      <li>Electrical and plumbing performance testing</li>
      <li>Indoor air quality, mold and pest inspection</li>
      <li>Waterproofing, drainage and leakage testing</li>
      <li>Legal, statutory and code compliance</li>
    </ul>
    <!-- Page footer removed: now page-level only -->
  </section>


  <div class="page-break"></div>

  <section style="display: flex; flex-direction: column; min-height: 100vh;">
    <!-- Letterhead removed: now page-level only -->
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <h1>Summary</h1>
    <div class="stats" style="grid-template-columns: repeat(4, 1fr); max-width: 900px; margin: 30px auto;">
      <div class="stat-box highlight" style="grid-column: span 1;">
        <div class="value" id="overallHealth">95%</div>
        <div class="label">Overall Unit Health</div>
      </div>
      <div id="roomHealthStats"
        style="grid-column: span 3; display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;"></div>
    </div>
    <!-- Page footer removed: now page-level only -->
  </section>

  <div class="page-break"></div>

  <section style="display: flex; flex-direction: column; min-height: 100vh;">
    <!-- Letterhead removed: now page-level only -->
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <h1>II. Area Check</h1>
    <table class="dimensions-table">
      <thead>
        <tr>
          <th class="dimensions-header" style="text-align: left; width: 15%;"></th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 32 L32 8 L56 32 L32 56 Z" fill="#f39c12" stroke="#e67e22" stroke-width="2" />
                <text x="32" y="38" text-anchor="middle" fill="white" font-size="20" font-weight="bold">√ó</text>
              </svg>
            </div>
            <div>DIMENSION (FT √ó FT)</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="8" y="8" width="48" height="48" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="4" />
                <text x="32" y="40" text-anchor="middle" fill="white" font-size="16" font-weight="bold">sq ft</text>
              </svg>
            </div>
            <div>AREA (SQ FT)</div>
          </th>
        </tr>
      </thead>
      <tbody id="areaTableBody"></tbody>
      <tfoot>
        <tr>
          <td colspan="2"
            style="text-align: center; background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; font-weight: 600; padding: 18px; border: none;">
            <strong>Total</strong>
          </td>
          <td
            style="text-align: center; background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; font-weight: 600; padding: 18px; border: none;">
            <strong id="totalAreaFoot">0</strong>
          </td>
        </tr>
      </tfoot>
    </table>
    <!-- Page footer removed: now page-level only -->
  </section>

  <div class="page-break"></div>

  <section style="display: flex; flex-direction: column; min-height: 100vh;">
    <!-- Letterhead removed: now page-level only -->
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <h1>Quality Check</h1>
    <div style="max-width: 450px; margin: 20px auto;">
      <canvas id="overallChart" style="max-height: 350px;"></canvas>
    </div>
    <h3 style="margin: 30px 0 15px 0;">Water Quality</h3>
    <div class="quality-grid" id="waterQualityGrid"
      style="grid-template-columns: repeat(2, 1fr); max-width: 700px; margin: 20px auto;">
      <div class="quality-item" style="border: 2px solid #4caf50; background: #fff; padding: 20px;">
        <div class="quality-header">
          <span class="quality-label">pH Level</span>
          <div class="quality-icon good">‚úì</div>
        </div>
        <div class="quality-value-container">
          <div class="quality-value" id="phValueDisplay" style="font-size: 40px;">7.0</div>
        </div>
        <div class="quality-range">Range: 6.5 - 8.5 ‚úì</div>
      </div>
      <div class="quality-item" style="border: 2px solid #4caf50; background: #fff; padding: 20px;">
        <div class="quality-header">
          <span class="quality-label">TDS</span>
          <div class="quality-icon good">‚úì</div>
        </div>
        <div class="quality-value-container">
          <div class="quality-value" id="tdsValueDisplay" style="font-size: 40px;">186</div>
          <span class="quality-unit" style="font-size: 18px;">mg/L</span>
        </div>
        <div class="quality-range">Less than 500 mg/L (desirable) ‚úì</div>
      </div>
    </div>
    <!-- Page footer removed: now page-level only -->
  </section>

  <div class="page-break"></div>

  <section>
    <!-- Letterhead removed: now page-level only -->
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <h1>IV. Dimensions Check</h1>
    <table class="dimensions-table">
      <thead>
        <tr>
          <th class="dimensions-header"></th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="4" y="4" width="24" height="24" fill="#D2B48C" stroke="#8B7355" stroke-width="2" />
                <rect x="32" y="4" width="24" height="24" fill="#C19A6B" stroke="#8B7355" stroke-width="2" />
                <rect x="4" y="32" width="24" height="24" fill="#C19A6B" stroke="#8B7355" stroke-width="2" />
                <rect x="32" y="32" width="24" height="24" fill="#D2B48C" stroke="#8B7355" stroke-width="2" />
              </svg>
            </div>
            <div>FLOORING</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="20" y="8" width="24" height="48" fill="#8B4513" stroke="#5D2E0F" stroke-width="2" rx="2" />
                <circle cx="38" cy="32" r="2.5" fill="#FFD700" />
              </svg>
            </div>
            <div>DOOR HEIGHT</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="4" y1="16" x2="60" y2="16" stroke="#E8E8E8" stroke-width="3" />
                <rect x="8" y="52" width="48" height="8" fill="#B8B8B8" />
              </svg>
            </div>
            <div>CEILING HEIGHT</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="12" y="12" width="40" height="40" fill="#87CEEB" stroke="#4682B4" stroke-width="3" rx="2" />
                <line x1="32" y1="12" x2="32" y2="52" stroke="#5F9EA0" stroke-width="2" />
                <line x1="12" y1="32" x2="52" y2="32" stroke="#5F9EA0" stroke-width="2" />
              </svg>
            </div>
            <div>WINDOW DIMENSION</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="8" y="12" width="12" height="16" fill="#CD853F" stroke="#8B4513" stroke-width="1.5" />
                <rect x="24" y="12" width="12" height="16" fill="#D2691E" stroke="#8B4513" stroke-width="1.5" />
                <rect x="40" y="12" width="12" height="16" fill="#CD853F" stroke="#8B4513" stroke-width="1.5" />
              </svg>
            </div>
            <div>TILES</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="8" y1="52" x2="56" y2="52" stroke="#696969" stroke-width="4" />
                <line x1="8" y1="52" x2="8" y2="32" stroke="#808080" stroke-width="3" />
                <line x1="56" y1="52" x2="56" y2="32" stroke="#808080" stroke-width="3" />
              </svg>
            </div>
            <div>RAILING HEIGHT</div>
          </th>
        </tr>
      </thead>
      <tbody id="dimensionsTableBody"></tbody>
    </table>
  </section>

  <div class="page-break"></div>

  <section style="display: flex; flex-direction: column; min-height: 100vh;">
    <!-- Letterhead removed: now page-level only -->
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <h1>V. Material Check</h1>
    <table class="dimensions-table">
      <thead>
        <tr>
          <th class="dimensions-header"></th>
          <th class="dimensions-header">
            <div class="dimension-icon">üì∑</div>
            <div>FLOORING</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">üß±</div>
            <div>WALL FINISH</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">üö™</div>
            <div>DOOR</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">ü™ü</div>
            <div>WINDOWS</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">üóùÔ∏è</div>
            <div>RAILING</div>
          </th>
        </tr>
      </thead>
      <tbody id="materialTableBody"></tbody>
    </table>
    <!-- Page footer removed: now page-level only -->
  </section>

  <div class="page-break"></div>

  <section style="display: flex; flex-direction: column; min-height: 100vh;">
    <!-- Letterhead removed: now page-level only -->
    <div class="letterhead">
      <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo"
        style="width: 120px; height: 120px;" />
      <div class="letterhead-text">
        <h2>TRINETRA</h2>
        <p>Professional Property Inspection Services</p>
      </div>
    </div>
    <h1>VI. Brand Check</h1>
    <table class="dimensions-table">
      <thead>
        <tr>
          <th class="dimensions-header"></th>
          <th class="dimensions-header">
            <div class="dimension-icon">üîå</div>
            <div>SWITCHBOARD</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">üåÄ</div>
            <div>FAN</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">üí°</div>
            <div>LIGHT</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">ü™ü</div>
            <div>WINDOWS</div>
          </th>
          <th class="dimensions-header">
            <div class="dimension-icon">‚ùÑÔ∏è</div>
            <div>AC</div>
          </th>
        </tr>
      </thead>
      <tbody id="brandTableBody"></tbody>
    </table>
    <!-- Page footer removed: now page-level only -->

    <!-- PAGE-LEVEL FOOTER -->

  </section>

  <div class="page-break"></div>

  <div id="roomQualityCharts"></div>

  <div class="page-break"></div>

  <script>
    (async function () {
      // ========== DYNAMIC PAGE NUMBERING ===========
      window.addEventListener('DOMContentLoaded', function () {
        setTimeout(() => {
          addFootersToAllSections();
        }, 300);
      });

      function addFootersToAllSections() {
        const allSections = Array.from(document.querySelectorAll('section'));
        let pageNum = 1;

        for (let i = 1; i < allSections.length; i++) {
          const section = allSections[i];

          if (section.classList.contains('dynamic-section')) {
            section.style.display = 'flex';
            section.style.flexDirection = 'column';
            section.style.minHeight = '100vh';
            section.style.justifyContent = 'space-between';
          } else {
            section.style.display = 'flex';
            section.style.flexDirection = 'column';
            section.style.minHeight = '100vh';
            section.style.justifyContent = 'space-between';
          }

          const oldFooter = section.querySelector('.page-footer');
          if (oldFooter) oldFooter.remove();

          let footer = document.createElement('div');
          footer.className = 'page-footer';
          footer.style.width = '100%';
          footer.style.display = 'flex';
          footer.style.justifyContent = 'space-between';
          footer.style.alignItems = 'center';
          footer.style.padding = '12px 40px';
          footer.style.borderTop = '2px solid #2c3e50';
          footer.style.marginTop = 'auto';
          footer.style.background = 'linear-gradient(to right, #ecf0f1 0%, #ffffff 100%)';
          footer.style.fontSize = '11px';
          footer.style.color = '#7f8c8d';

          let left = document.createElement('div');
          left.className = 'page-footer-left';
          left.style.display = 'flex';
          left.style.gap = '20px';
          left.innerHTML = '<span>¬© 2025 Trinetra - Professional Property Inspection Services</span><span><a href="mailto:info@trinetra.in">info@trinetra.in</a></span><span><a href="https://wa.me/9014607605" target="_blank">+91 9014607605</a></span>';
          footer.appendChild(left);

          let right = document.createElement('div');
          right.className = 'page-footer-right';
          right.style.textAlign = 'right';
          right.innerHTML = `Page <span class="dynamic-page-number">${pageNum}</span>`;
          footer.appendChild(right);

          section.appendChild(footer);
          pageNum++;
        }
      }

      // ========== DATA LOADING ===========
      const urlParams = new URLSearchParams(window.location.search);
      const dataParam = urlParams.get('data');
      let reportData = null;

      // Existing URL-based flow (kept)
      if (dataParam) {
        try {
          reportData = JSON.parse(decodeURIComponent(dataParam));
          console.log('‚úÖ Report data loaded from URL');
        } catch (e) {
          console.error('URL data parse error', e);
        }
      }

      // Added: Browser preview storage fallback using IndexedDB (non-breaking)
      if (!reportData) {
        try {
          const tempDB = new InspectionDB();
          reportData = await tempDB.getLatestReport();
          if (reportData) {
            console.log('‚úÖ Report data loaded from IndexedDB');
          }
        } catch (e) {
          console.warn("IndexedDB unavailable:", e);
        }
      }

      // Added: Playwright injected data fallback
      if (!reportData && window.__REPORT_DATA__) {
        reportData = window.__REPORT_DATA__;
        console.log('‚úÖ Report data loaded from Playwright injection');
      }

      if (!reportData) {
        document.body.innerHTML = '<div style="padding: 40px; text-align: center;"><h1>No data found</h1><p>Please generate a report from the inspection app.</p></div>';
      } else {
        // üìù Normalize incoming data without breaking existing logic
        const normalizedData = {
          clientName: reportData.clientName || "",
          propertyAddress: reportData.propertyAddress || "",
          verifierName: reportData.verifierName || "",
          inspectorName: reportData.inspectorName || reportData.inspector || "",
          inspectionDate: reportData.inspectionDate || "",
          generatedDate: reportData.generatedDate || "",

          rooms: Array.isArray(reportData.rooms) ? reportData.rooms : [],
          inspections: Array.isArray(reportData.inspections) ? reportData.inspections : [],

          checklist: reportData.checklist || {},

          quality: {
            major: reportData.quality?.major || 0,
            minor: reportData.quality?.minor || 0,
            cosmetic: reportData.quality?.cosmetic || 0,
            total: reportData.quality?.total || 0,
            water: reportData.quality?.water || {}
          },

          summary: reportData.summary || {}
        };

        console.log('üìä Normalized data:', normalizedData);
        populateReport(normalizedData);
      }

      function populateReport(data) {
        console.log('üé® Starting to populate report...');

        /* =============================
           BASIC HEADER DATA
        ============================== */
        if (data.clientName) {
          document.getElementById("clientName").textContent = data.clientName;
        }

        if (data.propertyAddress) {
          const addressElement = document.getElementById("propertyAddress");
          addressElement.innerHTML = data.propertyAddress.replace(/\n/g, '<br>');
        }

        if (data.verifierName) {
          document.getElementById("verifierName").textContent =
            "Verified by: " + data.verifierName;
        }

        if (data.inspectorName) {
          document.getElementById("inspectorName").textContent = data.inspectorName;
        }

        if (data.inspectionDate) {
          document.getElementById("inspectionDate").textContent = data.inspectionDate;
        }

        /* =============================
           AREA CHECK TABLE
        ============================== */
        const areaBody = document.getElementById("areaTableBody");
        areaBody.innerHTML = "";

        let totalArea = 0;

        data.rooms.forEach(room => {
          totalArea += room.totalArea || 0;

          if (room.dimensions && room.dimensions.length > 0) {
            room.dimensions.forEach((dim, index) => {
              const row = document.createElement("tr");

              if (index === 0) {
                row.innerHTML = `
              <td class="room-label" rowspan="${room.dimensions.length}">${room.name || "-"}</td>
              <td style="text-align:center;">${dim.length || 0} √ó ${dim.width || 0}</td>
              <td style="text-align:center;">${(dim.area || 0).toFixed(2)}</td>
            `;
              } else {
                row.innerHTML = `
              <td style="text-align:center;">${dim.length || 0} √ó ${dim.width || 0}</td>
              <td style="text-align:center;">${(dim.area || 0).toFixed(2)}</td>
            `;
              }

              areaBody.appendChild(row);
            });
          } else {
            const row = document.createElement("tr");
            row.innerHTML = `
          <td class="room-label">${room.name || "-"}</td>
          <td style="text-align:center;">0 √ó 0</td>
          <td style="text-align:center;">${(room.totalArea || 0).toFixed(2)}</td>
        `;
            areaBody.appendChild(row);
          }
        });

        document.getElementById("totalAreaFoot").textContent = totalArea.toFixed(2);

        /* =============================
           ROOM HEALTH STATS
        ============================== */
        const roomHealthStats = document.getElementById("roomHealthStats");
        if (roomHealthStats) {
          roomHealthStats.innerHTML = data.rooms.map(room => {
            const roomInspections = data.inspections.filter(i => i.room === room.name);
            const majorIssues = roomInspections.filter(i => i.issueType === 'Major').length;
            const minorIssues = roomInspections.filter(i => i.issueType === 'Minor').length;
            const cosmeticIssues = roomInspections.filter(i => i.issueType === 'Cosmetic').length;

            const healthScore = Math.max(0, 100 - (majorIssues * 5) - (minorIssues * 2) - (cosmeticIssues * 1));

            return `
          <div class="stat-box">
            <div class="value">${healthScore.toFixed(1)}</div>
            <div class="label">${room.name}</div>
          </div>
        `;
          }).join('');
        }

        const totalMajor = data.quality.major || 0;
        const totalMinor = data.quality.minor || 0;
        const totalCosmetic = data.quality.cosmetic || 0;

        // Deduction Model: Major: -5, Minor: -2, Cosmetic: -1
        const overallPercentage = Math.max(0, 100 - (totalMajor * 5) - (totalMinor * 2) - (totalCosmetic * 1));
        document.getElementById("overallHealth").textContent = overallPercentage.toFixed(0) + "%";

        /* =============================
           DIMENSIONS CHECK
        ============================== */
        const dimensionsBody = document.getElementById("dimensionsTableBody");
        dimensionsBody.innerHTML = "";

        data.rooms.forEach(room => {
          const details = room.dimensionDetails || {};
          const mainDim = room.dimensions && room.dimensions[0] ? room.dimensions[0] : {};

          let doorDim = "‚Äî";
          if (details.doorDimensions && details.doorDimensions.length > 0) {
            const door = details.doorDimensions[0];
            doorDim = `${door.height}ft √ó ${door.width}ft`;
          }

          let windowDim = "‚Äî";
          if (details.windowDimensions && details.windowDimensions.length > 0) {
            const window = details.windowDimensions[0];
            windowDim = `${window.height}ft √ó ${window.width}ft`;
          }

          let tileDim = "‚Äî";
          if (details.tileDimensions && details.tileDimensions.length > 0) {
            const tile = details.tileDimensions[0];
            tileDim = `${tile.length}ft √ó ${tile.width}ft`;
          }

          let flooringDim = "‚Äî";
          if (mainDim.length && mainDim.width) {
            flooringDim = room.materials?.flooring || "‚Äî";
          }

          const row = document.createElement("tr");
          row.innerHTML = `
        <td class="room-label">${room.name || "Room"}</td>
        <td>${flooringDim}</td>
        <td>${doorDim}</td>
        <td>${details.ceilingHeight ? details.ceilingHeight + 'ft' : "‚Äî"}</td>
        <td>${windowDim}</td>
        <td>${tileDim}</td>
        <td>${room.materials?.railing || "NA"}</td>
      `;
          dimensionsBody.appendChild(row);
        });

        /* =============================
           MATERIAL CHECK
        ============================== */
        const materialBody = document.getElementById("materialTableBody");
        materialBody.innerHTML = "";

        data.rooms.forEach(room => {
          const row = document.createElement("tr");
          row.innerHTML = `
        <td class="room-label">${room.name || "Room"}</td>
        <td>${room.materials?.flooring || "‚Äî"}</td>
        <td>${room.materials?.wallFinish || "‚Äî"}</td>
        <td>${room.materials?.door || "‚Äî"}</td>
        <td>${room.materials?.windows || "‚Äî"}</td>
        <td>${room.materials?.railing || "‚Äî"}</td>
      `;
          materialBody.appendChild(row);
        });

        /* =============================
           BRAND CHECK
        ============================== */
        const brandBody = document.getElementById("brandTableBody");
        brandBody.innerHTML = "";

        data.rooms.forEach(room => {
          const brands = room.brands || {};
          const row = document.createElement("tr");
          row.innerHTML = `
        <td class="room-label">${room.name || "Room"}</td>
        <td>${brands.switchboards || brands.Switchboards || "‚Äî"}</td>
        <td>${brands.fan || brands.Fan || "‚Äî"}</td>
        <td>${brands.lightFixtures || brands.LightFixtures || "‚Äî"}</td>
        <td>${brands.windows || brands.Windows || "‚Äî"}</td>
        <td>${brands.ac || brands.AC || brands.Ac || "‚Äî"}</td>
      `;
          brandBody.appendChild(row);
        });

        /* =============================
           QUALITY CHART
        ============================== */
        const ctx = document.getElementById("overallChart");
        if (ctx) {
          const majorCount = data.quality.major || 0;
          const minorCount = data.quality.minor || 0;
          const cosmeticCount = data.quality.cosmetic || 0;
          const total = majorCount + minorCount + cosmeticCount;

          if (total > 0) {
            new Chart(ctx, {
              type: "doughnut",
              data: {
                labels: ["Major Issues", "Minor Issues", "Cosmetic Issues"],
                datasets: [{
                  data: [majorCount, minorCount, cosmeticCount],
                  backgroundColor: ["#0072c3", "#33b1ff", "#bae6ff"],
                  borderWidth: 0,
                  borderRadius: 0
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: true,
                animation: false,
                cutout: '60%',
                plugins: {
                  legend: {
                    position: 'bottom',
                    labels: {
                      boxWidth: 20,
                      padding: 15,
                      font: { size: 13 },
                      generateLabels: function (chart) {
                        const data = chart.data;
                        if (data.labels.length && data.datasets.length) {
                          return data.labels.map((label, i) => {
                            const value = data.datasets[0].data[i];
                            return {
                              text: `  ${label}`,
                              fillStyle: data.datasets[0].backgroundColor[i],
                              hidden: false,
                              index: i
                            };
                          });
                        }
                        return [];
                      }
                    }
                  },
                  tooltip: {
                    callbacks: {
                      label: function (context) {
                        const label = context.label || '';
                        const value = context.parsed || 0;
                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                        return `${label}: ${value} (${percentage}%)`;
                      }
                    }
                  }
                }
              }
            });
          } else {
            ctx.parentElement.innerHTML = '<p style="text-align: center; color: #4caf50; font-size: 18px; padding: 40px;">No Issues Found - Property in Good Condition ‚úì</p>';
          }
        }

        /* =============================
           WATER QUALITY
        ============================== */
        const phValue = data.quality.water?.ph || '7.0';
        const tdsValue = data.quality.water?.tds || '186';

        document.getElementById('phValueDisplay').textContent = phValue;
        document.getElementById('tdsValueDisplay').textContent = tdsValue;

        const phNum = parseFloat(phValue);
        const tdsNum = parseFloat(tdsValue);

        const phCard = document.querySelector('.quality-item:first-child');
        const tdsCard = document.querySelector('.quality-item:last-child');

        if (phNum < 6.5 || phNum > 8.5) {
          phCard.style.borderColor = '#f44336';
          phCard.querySelector('.quality-value').style.color = '#f44336';
          phCard.querySelector('.quality-icon').classList.remove('good');
          phCard.querySelector('.quality-icon').classList.add('bad');
          phCard.querySelector('.quality-icon').textContent = '‚úï';
          phCard.querySelector('.quality-range').innerHTML = 'Range: 6.5 - 8.5 ‚úï <span style="color:#f44336;">Out of Range</span>';
        }

        if (tdsNum >= 500) {
          tdsCard.style.borderColor = '#f44336';
          tdsCard.querySelector('.quality-value').style.color = '#f44336';
          tdsCard.querySelector('.quality-unit').style.color = '#f44336';
          tdsCard.querySelector('.quality-icon').classList.remove('good');
          tdsCard.querySelector('.quality-icon').classList.add('bad');
          tdsCard.querySelector('.quality-icon').textContent = '‚úï';
          tdsCard.querySelector('.quality-range').innerHTML = 'Less than 500 mg/L (desirable) ‚úï <span style="color:#f44336;">Out of Range</span>';
        }

        /* =============================
           ROOM QUALITY CHARTS
        ============================== */
        const chartsContainer = document.getElementById('roomQualityCharts');
        chartsContainer.innerHTML = '';

        const roomIssues = {};
        data.inspections.forEach(insp => {
          if (!roomIssues[insp.room]) {
            roomIssues[insp.room] = [];
          }
          roomIssues[insp.room].push(insp);
        });

        Object.keys(roomIssues).forEach(roomName => {
          const roomInspections = roomIssues[roomName];

          const section = document.createElement('section');
          section.style.pageBreakInside = 'avoid';
          section.style.display = 'flex';
          section.style.flexDirection = 'column';
          section.style.minHeight = '100vh';
          section.style.justifyContent = 'space-between';

          section.innerHTML = `
  <!-- LETTERHEAD -->
  <div class="letterhead">
    <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo" style="width: 120px; height: 120px;" />
    <div class="letterhead-text">
      <h2>TRINETRA</h2>
      <p>Professional Property Inspection Services</p>
    </div>
  </div>
  
  <!-- CONTENT WRAPPER -->
  <div style="flex: 1;">
    <div style="background: #205d97; color: white; padding: 14px 24px; margin: 18px 0 18px 0; font-size: 17px; font-weight: 700; letter-spacing: 0.5px; border-radius: 0; text-transform: uppercase; box-shadow: none;">
      QUALITY CHECK: ${roomName.toUpperCase()}
    </div>
    
    <table class="inspection-table" style="margin-bottom: 24px; margin-top: 0;">
      <thead>
        <tr class="avoid-break">
          <th style="width: 80px;">S. NO.</th>
          <th style="width: 40%;">ISSUE</th>
          <th style="width: 50%;">PICTURE</th>
        </tr>
      </thead>
      <tbody>
        ${roomInspections.map((issue, idx) => {
            let imagesHTML = '<span style="color:#999;font-style:italic;font-size:14px;">No Image</span>';
            if (issue.images && issue.images.length > 0) {
              imagesHTML = '<div class="inspection-table-images">' +
                issue.images.map(img => `<img src="${img}" alt="Issue image" />`).join('') +
                '</div>';
            }

            return `
            <tr style="background-color: ${issue.issueType === 'Major' ? '#B3D9F2' : issue.issueType === 'Minor' ? '#CCE9FF' : '#E6F5FF'} !important;">
              <td>${idx + 1}</td>
              <td>
                <div style="line-height:1.8;">
                  <div style="margin-bottom:8px;font-size:15px;color:#2d2d2d;font-weight:500;">${issue.description || "‚Äî"}</div>
                </div>
              </td>
              <td>${imagesHTML}</td>
            </tr>
          `;
          }).join('')}
      </tbody>
    </table>
  </div>
  
  <!-- PAGE FOOTER -->
  <div class="page-footer" style="width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 12px 40px; border-top: 2px solid #2c3e50; margin-top: auto; background: linear-gradient(to right, #ecf0f1 0%, #ffffff 100%); font-size: 11px; color: #7f8c8d;">
    <div class="page-footer-left" style="display: flex; gap: 20px;">
      <span>¬© 2025 Trinetra - Professional Property Inspection Services</span>
      <span><a href="mailto:info@trinetra.in">info@trinetra.in</a></span>
      <span><a href="https://wa.me/9014607605" target="_blank">+91 9014607605</a></span>
    </div>
    <div class="page-footer-right" style="text-align: right;">
      Page <span class="dynamic-page-number"></span>
    </div>
  </div>
`;

          chartsContainer.appendChild(section);

          // PAGE BREAK
          const pageBreak = document.createElement('div');
          pageBreak.className = 'page-break';
          chartsContainer.appendChild(pageBreak);

          // ITEM WISE SUMMARY SECTION
          const summarySection = document.createElement('section');
          summarySection.style.display = 'flex';
          summarySection.style.flexDirection = 'column';
          summarySection.style.minHeight = '100vh';
          summarySection.style.justifyContent = 'space-between'; // ADD THIS
          summarySection.className = 'pdf-page';

          summarySection.innerHTML = `
  <!-- LETTERHEAD -->
  <div class="letterhead">
    <img src="assets/images/Trinetra.png" alt="Trinetra Logo" class="letterhead-logo" style="width: 120px; height: 120px;" />
    <div class="letterhead-text">
      <h2>TRINETRA</h2>
      <p>Professional Property Inspection Services</p>
    </div>
  </div>
  
  <!-- CONTENT -->
  <div style="flex: 1;">
    <div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 30px;">
      <h3 style="text-align: center; font-size: 16px; font-weight: 600; color: #333; margin-bottom: 20px; text-transform: uppercase;">
        ITEM WISE SUMMARY
      </h3>
      <div class="room-chart-wrapper avoid-break" style="height: 320px;">
        <canvas id="chart-${roomName.replace(/\s+/g, '-')}" width="600" height="300"></canvas>
      </div>
    </div>
  </div>
  
  <!-- PAGE FOOTER -->
  <div class="page-footer" style="width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 12px 40px; border-top: 2px solid #2c3e50; margin-top: auto; background: linear-gradient(to right, #ecf0f1 0%, #ffffff 100%); font-size: 11px; color: #7f8c8d;">
    <div class="page-footer-left" style="display: flex; gap: 20px;">
      <span>¬© 2025 Trinetra - Professional Property Inspection Services</span>
      <span><a href="mailto:info@trinetra.in">info@trinetra.in</a></span>
      <span><a href="https://wa.me/9014607605" target="_blank">+91 9014607605</a></span>
    </div>
    <div class="page-footer-right" style="text-align: right;">
      Page <span class="dynamic-page-number"></span>
    </div>
  </div>
`;

          chartsContainer.appendChild(summarySection);

          setTimeout(() => {
            const ctx = document.getElementById(`chart-${roomName.replace(/\s+/g, '-')}`);
            if (ctx) {
              const categories = {};
              roomInspections.forEach(insp => {
                if (!categories[insp.category]) {
                  categories[insp.category] = { Major: 0, Minor: 0, Cosmetic: 0 };
                }
                categories[insp.category][insp.issueType]++;
              });

              new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: Object.keys(categories),
                  datasets: [
                    {
                      label: 'Major Issues',
                      data: Object.keys(categories).map(cat => categories[cat].Major),
                      backgroundColor: '#0072c3'
                    },
                    {
                      label: 'Minor Issues',
                      data: Object.keys(categories).map(cat => categories[cat].Minor),
                      backgroundColor: '#33b1ff'
                    },
                    {
                      label: 'Cosmetic Issues',
                      data: Object.keys(categories).map(cat => categories[cat].Cosmetic),
                      backgroundColor: '#bae6ff'
                    }
                  ]
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: true,
                  animation: false,
                  scales: {
                    x: {
                      stacked: false,
                      grid: { display: false }
                    },
                    y: {
                      beginAtZero: true,
                      ticks: { stepSize: 1 },
                      title: { display: true, text: 'Identified Itemwise / Percentage %' }
                    }
                  },
                  plugins: {
                    legend: {
                      position: 'bottom',
                      labels: {
                        boxWidth: 15,
                        padding: 15,
                        font: { size: 12 }
                      }
                    }
                  }
                }
              });
            }
          }, 100);
        });

        console.log('‚úÖ Report population complete');
      }
    })();
  </script>
</body>

</html>